Dataset preparation (see diagrmams to understand table joit) 
DEVICE2023a_merged_codes_datas_dc_cleared.txt

======
DEVICE 
======
MDR_REPORT_KEY - id
DEVICE_EVENT_KEY 
IMPLANT_FLAG
DATE_REMOVED_FLAG
 U = Unknown
 A = Not available
 I = No information at this time
 M = Month and year provided only, day defaults to 01
 Y = Year provided only, day defaulted to 01, month defaulted to January

DEVICE_SEQUENCE_NO - from dev report
DATE_RECEIVED from mdr_dociment
BRAND_NAME
GENERIC_NAME
MANUFACTURER_D_NAME
MANUFACTURER_D_ADDRESS_1
MANUFACTURER_D_ADDRESS_2
MANUFACTURER_D_CITY
MANUFACTURER_D_STATE_CODE
MANUFACTURER_D_ZIP_CODE
MANUFACTURER_D_ZIP_CODE_EXT
MANUFACTURER_D_COUNTRY_CODE
MANUFACTURER_D_POSTAL_CODE
DEVICE_OPERATOR
EXPIRATION_DATE_OF_DEVICE
MODEL_NUMBER|CATALOG_NUMBER
LOT_NUMBER|OTHER_ID_NUMBER
DEVICE_AVAILABILITY Y-yes, N-no, R- returned to manufacturer
DATE_RETURNED_TO_MANUFACTURER
DEVICE_REPORT_PRODUCT_CODE
DEVICE_AGE_TEXT
DEVICE_EVALUATED_BY_MANUFACTUR
 Y = Yes
 N = No
 R = Device not returned to manufacturer
 * = No answer provided
COMBINATION_PRODUCT_FLAG
UDI-DI|UDI-PUBLIC

PROBLEM = problem code
PROBLEM_TXT - problem description

======
MDRFOI
======
MDR_REPORT_KEY
EVENT_KEY
REPORT_NUMBER
REPORT_SOURCE_CODE
	P = Voluntary report
	U = User Facility report
	D = Distributor report
	M = Manufacturer repor
MANUFACTURER_LINK_FLAG_
NUMBER_DEVICES_IN_EVENT
NUMBER_PATIENTS_IN_EVENT
DATE_RECEIVED
ADVERSE_EVENT_FLAG Y/N
PRODUCT_PROBLEM_FLAG Y/N
DATE_REPORT
DATE_OF_EVENT
REPROCESSED_AND_REUSED_FLAG
REPORTER_OCCUPATION_CODE
HEALTH_PROFESSIONAL
INITIAL_REPORT_TO_FDA
 Y = Yes
 N = No
 U = Unknown
 * = No answer provided
DATE_FACILITY_AWARE
REPORT_DATE
REPORT_TO_FDA
DATE_REPORT_TO_FDA
EVENT_LOCATION
DATE_REPORT_TO_MANUFACTURER
MANUFACTURER_CONTACT_T_NAME
MANUFACTURER_CONTACT_F_NAME
MANUFACTURER_CONTACT_L_NAME
MANUFACTURER_CONTACT_STREET_1
MANUFACTURER_CONTACT_STREET_2
MANUFACTURER_CONTACT_CITY
MANUFACTURER_CONTACT_STATE
MANUFACTURER_CONTACT_ZIP_CODE
MANUFACTURER_CONTACT_ZIP_EXT
MANUFACTURER_CONTACT_COUNTRY
MANUFACTURER_CONTACT_POSTAL
MANUFACTURER_CONTACT_AREA_CODE
MANUFACTURER_CONTACT_EXCHANGE
MANUFACTURER_CONTACT_PHONE_NO
MANUFACTURER_CONTACT_EXTENSION
MANUFACTURER_CONTACT_PCOUNTRY
MANUFACTURER_CONTACT_PCITY
MANUFACTURER_CONTACT_PLOCAL
MANUFACTURER_G1_NAME
MANUFACTURER_G1_STREET_1
MANUFACTURER_G1_STREET_2
MANUFACTURER_G1_CITY
MANUFACTURER_G1_STATE_CODE
MANUFACTURER_G1_ZIP_CODE
MANUFACTURER_G1_ZIP_CODE_EXT
MANUFACTURER_G1_COUNTRY_CODE
MANUFACTURER_G1_POSTAL_CODE
DATE_MANUFACTURER_RECEIVED
DEVICE_DATE_OF_MANUFACTURE
SINGLE_USE_FLAG
REMEDIAL_ACTION
 RC = Recall
 RP = Repair
 RL = Replace
 RB = Relabeling
 OT = Other
 NO = Notification
 IN = Inspection
 PM = Patient Monitoring
 MA = Modification/Adjustment
 * = Invalid Data
PREVIOUS_USE_CODE
REMOVAL_CORRECTION_NUMBER
EVENT_TYPE
 1 D = Death
 2 IN = Injury
 2 IL = Injury
 2 IJ = Injury
 3 M = Malfunction
 4 O = Other
 * = No answer provided
DISTRIBUTOR_NAME
DISTRIBUTOR_ADDRESS_1
DISTRIBUTOR_ADDRESS_2
DISTRIBUTOR_CITY
DISTRIBUTOR_STATE_CODE
DISTRIBUTOR_ZIP_CODE
DISTRIBUTOR_ZIP_CODE_EXT
REPORT_TO_MANUFACTURER
MANUFACTURER_NAME
MANUFACTURER_ADDRESS_1
MANUFACTURER_ADDRESS_2
MANUFACTURER_CITY
MANUFACTURER_STATE_CODE
MANUFACTURER_ZIP_CODE
MANUFACTURER_ZIP_CODE_EXT
MANUFACTURER_COUNTRY_CODE
MANUFACTURER_POSTAL_CODE
TYPE_OF_REPORT|SOURCE_TYPE
DATE_ADDED|DATE_CHANGED
REPORTER_COUNTRY_CODE
PMA_PMN_NUM
EXEMPTION_NUMBER
SUMMARY_REPORT
NOE_SUMMARIZED

=============
FOIDEVPROBLEM contains 2 fields, delimited by pipe (|), one record per line:
=============
1. Device Problem Code
2. Problem Description

==================
DEVICEPROBLEMCODES contains 2 fields, delimited by pipe (|), one record per line:
==================
1. MDR Report Key
2. Device Problem Code -- (F10) new added; 2006

======================================================================================
Dataset preperation:
1. Drop columns that no interest for us
'REPROCESSED_AND_REUSED_FLAG', 'REPORTER_OCCUPATION_CODE','HEALTH_PROFESSIONAL','INITIAL_REPORT_TO_FDA','DATE_FACILITY_AWARE','REPORT_DATE','REPORT_TO_FDA','DATE_REPORT_TO_FDA','EVENT_LOCATION','DATE_REPORT_TO_MANUFACTURER','MANUFACTURER_CONTACT_T_NAME','MANUFACTURER_CONTACT_F_NAME','MANUFACTURER_CONTACT_L_NAME','MANUFACTURER_CONTACT_STREET_1','MANUFACTURER_CONTACT_STREET_2','MANUFACTURER_CONTACT_CITY','MANUFACTURER_CONTACT_STATE','MANUFACTURER_CONTACT_ZIP_CODE','MANUFACTURER_CONTACT_ZIP_EXT','MANUFACTURER_CONTACT_COUNTRY','MANUFACTURER_CONTACT_POSTAL','MANUFACTURER_CONTACT_AREA_CODE','MANUFACTURER_CONTACT_EXCHANGE','MANUFACTURER_CONTACT_PHONE_NO','MANUFACTURER_CONTACT_EXTENSION','MANUFACTURER_CONTACT_PCOUNTRY','MANUFACTURER_CONTACT_PCITY','MANUFACTURER_CONTACT_PLOCAL','MANUFACTURER_G1_STREET_1','MANUFACTURER_G1_STREET_2','MANUFACTURER_G1_CITY','MANUFACTURER_G1_STATE_CODE','MANUFACTURER_G1_ZIP_CODE','MANUFACTURER_G1_ZIP_CODE_EXT','MANUFACTURER_G1_COUNTRY_CODE','MANUFACTURER_G1_POSTAL_CODE','DATE_MANUFACTURER_RECEIVED','DEVICE_DATE_OF_MANUFACTURE','SINGLE_USE_FLAG','PREVIOUS_USE_CODE','REMOVAL_CORRECTION_NUMBER','DISTRIBUTOR_ADDRESS_1','DISTRIBUTOR_ADDRESS_2','DISTRIBUTOR_CITY','DISTRIBUTOR_STATE_CODE','DISTRIBUTOR_ZIP_CODE','DISTRIBUTOR_ZIP_CODE_EXT','REPORT_TO_MANUFACTURER','MANUFACTURER_ADDRESS_1','MANUFACTURER_ADDRESS_2','MANUFACTURER_CITY','MANUFACTURER_STATE_CODE','MANUFACTURER_ZIP_CODE','MANUFACTURER_ZIP_CODE_EXT','MANUFACTURER_COUNTRY_CODE','MANUFACTURER_POSTAL_CODE','SOURCE_TYPE','DATE_ADDED','DATE_CHANGED','REPORTER_COUNTRY_CODE','PMA_PMN_NUM','EXEMPTION_NUMBER','SUMMARY_REPORT','NOE_SUMMARIZED','DEVICE_EVENT_KEY','IMPLANT_FLAG,'DATE_REMOVED_FLAG','DEVICE_SEQUENCE_NO','DATE_RECEIVED','DISTRIBUTOR_ADDRESS_1','DISTRIBUTOR_ADDRESS_2','DISTRIBUTOR_CITY','DISTRIBUTOR_STATE_CODE','DISTRIBUTOR_ZIP_CODE','DISTRIBUTOR_ZIP_CODE_EXT','REPORT_TO_MANUFACTURER','MANUFACTURER_ADDRESS_1','MANUFACTURER_ADDRESS_2','MANUFACTURER_CITY','MANUFACTURER_STATE_CODE','MANUFACTURER_ZIP_CODE','MANUFACTURER_ZIP_CODE_EXT','MANUFACTURER_COUNTRY_CODE','MANUFACTURER_POSTAL_CODE','MANUFACTURER_D_ADDRESS_1','MANUFACTURER_D_ADDRESS_2','MANUFACTURER_D_CITY','MANUFACTURER_D_STATE_CODE','MANUFACTURER_D_ZIP_CODE','MANUFACTURER_D_ZIP_CODE_EXT','MANUFACTURER_D_COUNTRY_CODE','MANUFACTURER_D_POSTAL_CODE','DEVICE_OPERATOR','EXPIRATION_DATE_OF_DEVICE','MODEL_NUMBER','CATALOG_NUMBER','LOT_NUMBER','OTHER_ID_NUMBER','DEVICE_AVAILABILITY','DATE_RETURNED_TO_MANUFACTURER','DEVICE_REPORT_PRODUCT_CODE','DEVICE_EVALUATED_BY_MANUFACTUR','COMBINATION_PRODUCT_FLAG','UDI-DI','UDI-PUBLIC' 

After clean up columns left:
MDR_REPORT_KEY|EVENT_KEY|REPORT_NUMBER|REPORT_SOURCE_CODE|MANUFACTURER_LINK_FLAG_|NUMBER_DEVICES_IN_EVENT|NUMBER_PATIENTS_IN_EVENT|ADVERSE_EVENT_FLAG|PRODUCT_PROBLEM_FLAG|DATE_REPORT|DATE_OF_EVENT|MANUFACTURER_G1_NAME|REMEDIAL_ACTION|EVENT_TYPE|DISTRIBUTOR_NAME|MANUFACTURER_NAME|TYPE_OF_REPORT|BRAND_NAME|GENERIC_NAME|MANUFACTURER_D_NAME|DEVICE_AGE_TEXT|PROBLEM|PROBLEM_TXT


2. Replace EVENT_TYPE:
	If D: 1
	If IN, IL, IJ: 2
	If M: 3
	If any other value: Delete entrie row from the list.
	
	Replace REMEDIAL_ACTION: 
		If RC: 1 = Recall
		If RP: 2 = Repair
		If RL: 3 = Replace
		If RB: 4 = Relabeling
		If OT: 5 = Other
		If NO: 6 = Notification
		If IN: 7 = Inspection
		If PM: 8 = Patient Monitoring
		If MA: 9 = Modification/Adjustment
		If any other value: Delete entrie row from the list. * = Invalid Data
3. Drop NA rows: 
	'EVENT_TYPE', 'REMEDIAL_ACTION', 'ADVERSE_EVENT_FLAG', 'PRODUCT_PROBLEM_FLAG', 'GENERIC_NAME'
4. Encode values:
	ADVERSE_EVENT_FLAG
	PRODUCT_PROBLEM_FLAG
	GENERIC_NAME

==============
Use fields: 
==============
EVENT_TYPE 
 1 D = Death
 2 IN = Injury
 2 IL = Injury
 2 IJ = Injury
 3 M = Malfunction

REMEDIAL_ACTION
 1 RC = Recall
 2 RP = Repair
 3 RL = Replace
 4 RB = Relabeling
 5 OT = Other
 6 NO = Notification
 7 IN = Inspection
 8 PM = Patient Monitoring
 9 MA = Modification/Adjustment
 0 = Invalid Data
 
ADVERSE_EVENT_FLAG Y/N
PRODUCT_PROBLEM_FLAG Y/N
GENERIC_NAME - text

============================================================
Steps:

Data Cleaning and Pre-processing:

We'll handle missing values appropriately. Many columns have a significant number of missing values, which we might need to drop or impute.
Convert categorical variables like ADVERSE_EVENT_FLAG and PRODUCT_PROBLEM_FLAG into numeric codes.
Parse dates if necessary for any time-series analysis.
Feature Selection:

For predictive modeling, we will use the following fields: EVENT_TYPE, REMEDIAL_ACTION, ADVERSE_EVENT_FLAG, PRODUCT_PROBLEM_FLAG, and GENERIC_NAME. We will create a target variable based on EVENT_TYPE, categorizing certain types as device failures.
Model Setup:

Split the data into training (80%) and testing (20%) sets.
Train multiple models: Logistic Regression, Decision Tree, Random Forest, and Gradient Boosting.
Evaluate them based on accuracy, precision, recall, and F1 score.
Model Implementation:

We will implement this setup using scikit-learn, a popular Python library for machine learning.
============================================================
Output:
C:\Users\Sergio\AppData\Local\Programs\Python\Python310\python.exe C:\study\ML_CLass\Final\DS\mergingDS\main.py 
{'Logistic Regression': (0.9834444412800162, 0.9854324906473189, 0.9721142716551944, 0.9787280757310904), 'Decision Tree': (0.9853942159605489, 0.9916052766832277, 0.9709400180052227, 0.9811638465645987), 'Random Forest': (0.985424886573501, 0.9915161341889516, 0.9711077685266472, 0.9812058430533938), 'Gradient Boosting': (0.9841301485553046, 0.9858431534658791, 0.9734730508787331, 0.9796190529780829)}

Process finished with exit code 0
============================================================